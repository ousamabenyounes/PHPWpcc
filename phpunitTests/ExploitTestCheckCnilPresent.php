<?
require("ExploitTestCheck.php");
class ExploitTestCheckCnilTest extends ExploitTestCheck {

   // Check if the given webSiteContent is compatible with allowed Cnil configuration
   // @params String $html Given html content
   // @return Boolean
   public function ExploitTestCheckCnilPresent($html) {
    // Check minOld configuration
    if (FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/css/cnil-min-v1.0.1.css") &&
     FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/js/cnil-min-v1.2.1.js")) {
         return true;
    }
    // Check minArchimade configuration
    if (FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/css/cnil-min-v20140612.css") &&
     FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/js/cnil-min-v20140627.js")) {
         return true;
    }
    // Check minLast configuration
    if (FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/css/cnil-min-v20140612.css") &&
     FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/js/cnil-min-v20140703.js")) {
         return true;
    }
    // Check minCurent configuration
    if (FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/css/cnil-min-v20140904.css") &&
     FALSE !== strpos($html, "http://newsletters.francetv.fr/cnil/js/cnil-min-v20140627.js")) {
         return true;
    }
    return false;
  }
}